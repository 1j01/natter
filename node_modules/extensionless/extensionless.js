var fs = require("fs");
module.exports = function (public_dir, exts) {
	exts = exts || ["html"];
	return function (req, res, next) {
		if (req.path.indexOf('.') === -1) {
			var i = 0;
			var check = function () {
				fs.exists(public_dir + req.path + '.' + exts[i], function (exists) {
					if (exists) {
						req.url += '.' + exts[i];
						console.log(req.path);
						next();
					} else {
						if (++i >= exts.length) {
							next();
						} else {
							check();
						}
					}
				});
			};
			check();
		} else {
			next();
		}
	}
};