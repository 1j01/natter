function CleverBotResponse(a){this.question=a[8],this.answer=a[16]}var C=require("crypto").createHash,H=require("http"),Q=require("querystring").stringify,P="sessionid logurl vText8 vText7 vText6 vText5 vText4 vText3 vText2 prevref emotionalhistory ttsLocMP3 ttsLocTXT ttsLocTXT3 ttsText lineRef lineURL linePOST lineChoices lineChoicesAbbrev typingData divert".split(" "),$=module.exports=function(a){return a=this,a instanceof $?(a._={start:"y",icognoid:"wsf",fno:0,sub:"Say",islearning:1,cleanslate:"false"},a.backlog=[],void 0):new $};$.prototype.think=function(a,b){!b&&(b=a,a="{pass}");var c,g,d=Error,e=this,a=e._.stimulus=a,f=0,h="",i="www.cleverbot.com",j="http://"+i,h=Q((e._.icognocheck=C("md5").update(Q(e._).substring(9,35)).digest("hex"),e._));H.request({method:"POST",host:i,path:"/webservicemin",port:"80",headers:{Origin:j,Referer:j,Accept:"*/*","Content-Type":"application/x-www-form-urlencoded","Content-Length":h.length}},function(a){a.on("data",function(a){h+=a}).on("end",function(i){if(i=a.statusCode,200!=i)b(d("HTTP "+i));else if("DENIED"==h)b(d("Access Denied"));else if(h.match(/\r.*\r.*\r/)){for(g=h.split("\r");f<P.length;)e._[P[f]]=g[++f];r=new CleverBotResponse(g),b(r.answer===c?d("undefined?"):void e.backlog.push(r),r.answer)}else b(d("Not enough lines?"))}).setEncoding("utf8")}).on("error",b).end(h)};